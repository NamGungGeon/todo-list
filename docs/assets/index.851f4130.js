var D=Object.defineProperty,y=Object.defineProperties;var E=Object.getOwnPropertyDescriptors;var g=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var C=(t,e,r)=>e in t?D(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,m=(t,e)=>{for(var r in e||(e={}))S.call(e,r)&&C(t,r,e[r]);if(g)for(var r of g(e))T.call(e,r)&&C(t,r,e[r]);return t},f=(t,e)=>y(t,E(e));var d=(t,e,r)=>(C(t,typeof e!="symbol"?e+"":e,r),r);const B=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerpolicy&&(n.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?n.credentials="include":s.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(s){if(s.ep)return;s.ep=!0;const n=r(s);fetch(s.href,n)}};B();const L=()=>{const t=document.createElement("div");return t.setAttribute("class","divider"),t},A=t=>{const e=document.createElement("div");e.innerHTML=`
    <input type='text' placeholder='\uD560 \uC77C \uCD94\uAC00' id='createTodo'/>
  `;const r=e.querySelector("#createTodo");return r.addEventListener("keydown",o=>{if(o.code==="Enter"){const s=r.value;s.length>0&&t(s)}}),e},I=(t=new Date)=>{let e=t.getFullYear(),r=t.getMonth()+1;r<10&&(r=`0${r}`);let o=t.getDate();return o<10&&(o=`0${o}`),`${e}-${r}-${o}`},O=t=>{const e=document.createElement("div");return e.setAttribute("class","header"),e.innerHTML=`
    <h1>${I()}</h1>
    <p class='msg'>\uD560 \uC77C\uC774 ${t}\uAC1C \uB0A8\uC558\uC2B5\uB2C8\uB2E4</p>
  `,e};let c=-1;const $=(t,e)=>{const r=document.createElement("div");r.setAttribute("class",`todo ${t.completed?"completed":""}`),r.setAttribute("draggable","true"),r.setAttribute("id",`todo-${t.id}`),r.innerHTML=`
    <div class='content'>
      <span class='checkbox'></span>
      ${t.id===c?`<input type='text' value='${t.title}' class='nextTitle' placeholder='\uBCC0\uACBD\uD560 \uC774\uB984\uC744 \uC785\uB825\uD558\uC138\uC694'/>`:`<h3 class="title">${t.title}</h3>`}
    </div>
    <div class='options'>
      <button class='updateBtn'>\uBCC0\uACBD</button>
      <button class='deleteBtn'>\uC0AD\uC81C</button>
    </div>
  `,r.addEventListener("dragstart",s=>{var n;(n=s.dataTransfer)==null||n.setData("todoId",t.id.toString()),r.classList.add("fear")}),r.addEventListener("dragend",s=>{r.classList.remove("fear")}),r.querySelector(".content").addEventListener("click",()=>{t.completed=!t.completed,e(t)});const o=r.querySelector(".nextTitle");return o==null||o.addEventListener("click",s=>{s.stopPropagation()}),o==null||o.addEventListener("change",()=>{c=-1,(o==null?void 0:o.value)&&(t.title=o.value),e(t)}),r.querySelector(".deleteBtn").addEventListener("click",()=>{t.id=-1,e(t)}),r.querySelector(".updateBtn").addEventListener("click",()=>{t.id!==c?c=t.id:c=-1,e(t)}),r};class h{constructor(e,r,o,s){d(this,"completed",!1);d(this,"id",-1);d(this,"title","");d(this,"userId",-1);this.completed=e,this.id=r,this.title=o,this.userId=s}static createFromJson(e){const{completed:r,id:o,title:s,userId:n}=e;return new h(r,o,s,n)}}var q=[{userId:1,id:1,title:"delectus aut autem",completed:!1},{userId:1,id:2,title:"quis ut nam facilis et officia qui",completed:!1},{userId:1,id:3,title:"fugiat veniam minus",completed:!1},{userId:1,id:4,title:"et porro tempora",completed:!0}];class F{constructor(e){d(this,"state");d(this,"observers",[]);this.state=e}setState(e){this.state=e,this.observers.forEach(r=>{r(this.state)})}addObserver(e){this.observers.push(e)}removeObserver(e){for(let r=0;r<this.observers.length;r++)if(this.observers[r]===e){this.observers.splice(r,1);break}}removeAllObservers(){for(;this.observers.length;)this.observers.pop()}}const N=t=>{const e=document.createElement("div");return e.setAttribute("id","trashhole"),e.addEventListener("dragover",r=>{r.preventDefault(),e.classList.add("active")}),e.addEventListener("dragleave",r=>{r.preventDefault(),e.classList.remove("active")}),e.addEventListener("drop",r=>{var s;r.preventDefault(),e.classList.remove("active"),console.log("on Drop",r);const o=Number(((s=r.dataTransfer)==null?void 0:s.getData("todoId"))||0);o>0&&t(o)}),e.innerHTML=`
    <p>\uC774\uACF3\uC5D0 \uC0AD\uC81C\uD560 \uD560 \uC77C\uC744 \uB4DC\uB798\uADF8&\uB4DC\uB86D \uD558\uC138\uC694</p>
  `,e},u=new F({todoList:[]}),l=document.querySelector("#app"),k=t=>t.length?t[t.length-1].id+1:1,w=t=>{const{todoList:e}=t;console.log("renderUI",b),e.every((i,a)=>i.id===-1?(e.splice(a,1),!1):!0),l.innerHTML="";const r=e.reduce((i,a)=>a.completed?i:i+1,0);l.appendChild(O(r)),l.appendChild(L()),l.appendChild(N(i=>{const a=e.findIndex(p=>p.id===i);if(a!==-1){const p=[...e];p.splice(a,1),u.setState(f(m({},t),{todoList:p}))}}));const o=document.createElement("div");l.appendChild(o);const s=i=>{console.log("update target todo",i),u.setState(f(m({},t),{todoList:[...e]}))};e.map(i=>{const a=$(i,s);o.appendChild(a)}),e.length===0&&o.remove(),l.appendChild(L());const n=i=>{console.log(i),u.setState(f(m({},t),{todoList:[...e,new h(!1,k(e),i,1)]}))};l.appendChild(A(n))};let v=localStorage.getItem("todoList");if(v)try{v=JSON.parse(v)}catch(t){console.error("savedTodoListData","JSON parse error",t)}const H=v||[...q],b=H.map(t=>{try{return h.createFromJson(t)}catch(e){return console.error("createFromJSON",e),null}}).filter(t=>t!==null);u.addObserver(t=>{const{todoList:e}=t;w(t),localStorage.setItem("todoList",JSON.stringify(e))});u.setState({todoList:b});
