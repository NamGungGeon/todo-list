var A=Object.defineProperty,I=Object.defineProperties;var O=Object.getOwnPropertyDescriptors;var y=Object.getOwnPropertySymbols;var w=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var S=(t,e,s)=>e in t?A(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,p=(t,e)=>{for(var s in e||(e={}))w.call(e,s)&&S(t,s,e[s]);if(y)for(var s of y(e))$.call(e,s)&&S(t,s,e[s]);return t},v=(t,e)=>I(t,O(e));var m=(t,e,s)=>(S(t,typeof e!="symbol"?e+"":e,s),s);const q=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const d of o.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function s(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerpolicy&&(o.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?o.credentials="include":r.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=s(r);fetch(r.href,o)}};q();const D=()=>{const t=document.createElement("div");return t.setAttribute("class","divider"),t},F=t=>{const e=document.createElement("div");e.innerHTML=`
    <input type='text' placeholder='\uD560 \uC77C \uCD94\uAC00' id='createTodo'/>
  `;const s=e.querySelector("#createTodo");return s.addEventListener("keydown",n=>{if(n.code==="Enter"){const r=s.value;r.length>0&&t(r)}}),e},k=(t=new Date)=>{let e=t.getFullYear(),s=t.getMonth()+1;s<10&&(s=`0${s}`);let n=t.getDate();return n<10&&(n=`0${n}`),`${e}-${s}-${n}`},N=t=>{const e=document.createElement("div");return e.setAttribute("class","header"),e.innerHTML=`
    <h1>${k()}</h1>
    <p class='msg'>\uD560 \uC77C\uC774 ${t}\uAC1C \uB0A8\uC558\uC2B5\uB2C8\uB2E4</p>
  `,e};let C=-1;const H=(t,e,s)=>{const n=document.createElement("div");n.setAttribute("class",`todo ${t.completed?"completed":""}`),n.setAttribute("draggable","true"),n.setAttribute("id",`todo-${t.id}`),n.innerHTML=`
    <div class='content'>
      <span class='checkbox'></span>
      ${t.id===C?`<input type='text' value='${t.title}' class='nextTitle' placeholder='\uBCC0\uACBD\uD560 \uC774\uB984\uC744 \uC785\uB825\uD558\uC138\uC694'/>`:`<h3 class="title">${t.title}</h3>`}
    </div>
    <div class='options'>
      <button class='updateBtn'>\uBCC0\uACBD</button>
      <button class='deleteBtn'>\uC0AD\uC81C</button>
    </div>
  `,n.addEventListener("dragstart",o=>{var d;(d=o.dataTransfer)==null||d.setData("todoId",t.id.toString()),n.classList.add("fear")}),n.addEventListener("dragend",o=>{n.classList.remove("fear")}),n.addEventListener("drop",o=>{var h;o.preventDefault();const d=Number(((h=o.dataTransfer)==null?void 0:h.getData("todoId"))||0);d>0&&s(t,d)}),n.addEventListener("dragover",o=>{o.preventDefault(),n.classList.add("swap")}),n.addEventListener("dragleave",o=>{o.preventDefault(),n.classList.remove("swap")}),n.querySelector(".content").addEventListener("click",()=>{t.completed=!t.completed,e(t)});const r=n.querySelector(".nextTitle");return r==null||r.addEventListener("click",o=>{o.stopPropagation()}),r==null||r.addEventListener("change",()=>{C=-1,(r==null?void 0:r.value)&&(t.title=r.value),e(t)}),n.querySelector(".deleteBtn").addEventListener("click",()=>{t.id=-1,e(t)}),n.querySelector(".updateBtn").addEventListener("click",()=>{t.id!==C?C=t.id:C=-1,e(t)}),n};class b{constructor(e,s,n,r){m(this,"completed",!1);m(this,"id",-1);m(this,"title","");m(this,"userId",-1);this.completed=e,this.id=s,this.title=n,this.userId=r}static createFromJson(e){const{completed:s,id:n,title:r,userId:o}=e;return new b(s,n,r,o)}}var M=[{userId:1,id:1,title:"delectus aut autem",completed:!1},{userId:1,id:2,title:"quis ut nam facilis et officia qui",completed:!1},{userId:1,id:3,title:"fugiat veniam minus",completed:!1},{userId:1,id:4,title:"et porro tempora",completed:!0}];class x{constructor(e){m(this,"state");m(this,"observers",[]);this.state=e}setState(e){this.state=e,this.observers.forEach(s=>{s(this.state)})}addObserver(e){this.observers.push(e)}removeObserver(e){for(let s=0;s<this.observers.length;s++)if(this.observers[s]===e){this.observers.splice(s,1);break}}removeAllObservers(){for(;this.observers.length;)this.observers.pop()}}const J=t=>{const e=document.createElement("div");return e.setAttribute("id","trashhole"),e.addEventListener("dragover",s=>{s.preventDefault(),e.classList.add("active")}),e.addEventListener("dragleave",s=>{s.preventDefault(),e.classList.remove("active")}),e.addEventListener("drop",s=>{var r;s.preventDefault(),e.classList.remove("active"),console.log("on Drop",s);const n=Number(((r=s.dataTransfer)==null?void 0:r.getData("todoId"))||0);n>0&&t(n)}),e.innerHTML=`
    <p>\uC774\uACF3\uC5D0 \uC0AD\uC81C\uD560 \uD560 \uC77C\uC744 \uB4DC\uB798\uADF8&\uB4DC\uB86D \uD558\uC138\uC694</p>
  `,e},u=new x({todoList:[],listingStyle:"listing-vertical"}),c=document.querySelector("#app"),P=t=>t.length?t[t.length-1].id+1:1,R=t=>{const{todoList:e,listingStyle:s}=t;console.log("renderUI",E),e.every((i,l)=>i.id===-1?(e.splice(l,1),!1):!0),c.innerHTML="";const n=e.reduce((i,l)=>l.completed?i:i+1,0);c.appendChild(N(n)),c.appendChild(D()),c.appendChild(J(i=>{const l=e.findIndex(f=>f.id===i);if(l!==-1){const f=[...e];f.splice(l,1),u.setState(v(p({},t),{todoList:f}))}}));const r=document.createElement("div");r.classList.add("todoStyleOptions"),r.innerHTML=`
    <button id="listingRowButton">\uB9AC\uC2A4\uD2B8\uBCF4\uAE30</button>
    &nbsp;&nbsp;
    <button id="listingColumnButton">\uACA9\uC790\uBCF4\uAE30</button>
  `,r.querySelector("#listingRowButton").addEventListener("click",()=>{u.setState(v(p({},t),{listingStyle:"listing-vertical"}))}),r.querySelector("#listingColumnButton").addEventListener("click",()=>{u.setState(v(p({},t),{listingStyle:"listing-grid"}))}),c.appendChild(r);const o=document.createElement("div");o.classList.add("todolist"),o.classList.add(s),c.appendChild(o);const d=i=>{console.log("update target todo",i),u.setState(v(p({},t),{todoList:[...e]}))},h=(i,l)=>{console.log("handleSwap");const f=i.id,g=[e.findIndex(a=>a.id===f),e.findIndex(a=>a.id===l)];if(g[0]!==-1&&g[1]!==-1){const a=[...e],T=a[g[0]];a[g[0]]=a[g[1]],a[g[1]]=T,u.setState(v(p({},t),{todoList:a}))}};e.map(i=>{const l=H(i,d,h);o.appendChild(l)}),e.length===0&&o.remove(),c.appendChild(D());const B=i=>{console.log(i),u.setState(v(p({},t),{todoList:[...e,new b(!1,P(e),i,1)]}))};c.appendChild(F(B))};let L=localStorage.getItem("todoList");if(L)try{L=JSON.parse(L)}catch(t){console.error("savedTodoListData","JSON parse error",t)}const K=L||[...M],E=K.map(t=>{try{return b.createFromJson(t)}catch(e){return console.error("createFromJSON",e),null}}).filter(t=>t!==null);u.addObserver(t=>{const{todoList:e}=t;R(t),localStorage.setItem("todoList",JSON.stringify(e))});u.setState({todoList:E,listingStyle:"listing-vertical"});
